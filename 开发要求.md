# 开发要求
## 任务介绍
我在做安卓开发，并研究如何利用AI来复刻公开的京东APP，但我的复刻无需100%相似，我只需要做到如下几点：
- 1、UI结构基本相似，图标做不到一模一样不要紧，类似即可。
- 2、不需要做出APP的所有页面，例如京东APP，我们只做app需实现的任务用到的典型页面就可以了，其他的页面，比如小视频、秒送页面，我们全部设置为空页面，只保留一个入口给后续开发接入，暂时不需要处理。
- 3、不需要实现动态，例如不需要实现动态数据，商品列表、店铺信息等全部固定死。
- 4、不需要数据库，但是需要保存重要的信号（这些信号我会指定），如购物车商品、订单状态
- 5、不需要登录和联网，仅为本地演示使用
- 6、开发过程，可以考虑截图给AI，让AI实现开发任务。
- 7、没有任何限制，对框架等的选取完全取决于开发者习惯
- 8、不需要通知权限等复杂的东西，至多需要下保存图片到本地、读取相册这样的权限

## 任务要求
1. 开发的时候可以采取逐步开发的策略，慢慢补充需求，慢慢新增数据字段等
2. 避免单个文件代码过长，**必须要遵循MVP模式**
3. 按照指定的页面结构、参考给定的截图作为UI设计指导
4. 严格按照已经定义好的数据结构`app\src\main\java\com\example\MyJD\model`和已有的数据`app\src\main\assets\data`
5. 按照用户要求进行开发，除非用户指定，否则不要引入新的内容。
    - 你只需要参考我给你的截图，**不要脑补**截图中各个按钮点击后会达到的效果。
    - ***截图里面的信息（例如人的名字、人的头像）不必参考***，因为我们自己预设了已有的数据`app\src\main\assets\data`
6. UI中，各个图标若找不到合适的，可以用emoji表情代替。但优先考虑`androidx.compose.material.icons.Icons, androidx.compose.material.icons.filled.AccountCircle`等
7. 严禁执行删除文件等危险操作。
8. 每当你修改完代码，记得更新`README.md`文件，并且确定build正常了再交付给我。禁止修改`需求.md`.
9. 如果你需要图片支持，请给我反馈，告诉我需要什么图片。如果你使用了我给你的图片，记得把图片名改为一个可读的名字，便于后期维护。

## 页面树
```json
{
   "MainActivity": [
      "HomeTab/ProductDetailActivity/ProductSpecDialog", 
      "VideoTab",
      "ChatTab/ChatDetailActivity",
      "CartTab",
      "MeTab"
   ]
}

```

## 已完成的页面
'''
1. HomeTab
2. ChatTab
3. CartTab
4. MeTab
'''

## 可参考的截图
1. UIReference/CartTab参考.png 
2. UIReference/规格选择参考.png

## 你当前的任务
设计 **ProductSpecDialog（规格选择页）**，更新CartTab（购物车页）：

## 规格选择弹窗（ProductSpecDialog）开发需求

### 任务介绍
在商品详情页点击"加入购物车"或"立即购买"按钮时，弹出规格选择弹窗，用户可选择商品系列、颜色外观、存储容量等规格，并调整购买数量，确认后将商品加入购物车或跳转至订单确认页。

---

### 页面要素详细说明

#### **顶部关闭按钮（CloseButton）**
- 位置：弹窗右上角
- 图标：`✕` 或 `Icons.Filled.Close`
- 颜色：`#666666`
- 大小：24dp
- 点击后关闭弹窗

---

#### **商品信息区（ProductInfoHeader）**
- **商品缩略图（ProductThumbnail）**
  - 位置：左侧
  - 尺寸：80dp × 80dp
  - 圆角：8dp
  - 显示当前选中颜色的商品图片

- **价格信息（PriceInfo）**
  - 主价格：`¥3799`，字号：24sp Bold，颜色：红色 `#E2231A`
  - 补贴标签：`政府补贴价`，背景色：绿色 `#4CAF50`，文字白色，圆角：4dp
  - 原价：`¥3899`，字号：14sp，颜色：`#999999`，删除线
  - 补贴说明：
    - `政府补贴已减100` - 绿色背景标签
    - `国家贴息 12期免息` - 绿色背景标签
  - 标签样式：
    - 背景色：`#E8F5E9`（浅绿色）
    - 文字颜色：`#4CAF50`（绿色）
    - 圆角：4dp
    - padding：4dp 8dp
    - 字号：12sp

- **商品编号（ProductSKU）**
  - 显示文字：`编号：100066896464`
  - 字号：12sp
  - 颜色：`#999999`

---

#### **数量选择区（QuantitySelector）**
- **减少按钮（MinusButton）**
  - 图标：`-`
  - 尺寸：32dp × 32dp
  - 边框：1dp，颜色：`#DDDDDD`
  - 圆角：4dp
  - 点击后数量减1，最小值为1
  - 当数量为1时按钮置灰不可点击

- **数量显示（QuantityDisplay）**
  - 显示当前数量，如：`1`
  - 字号：16sp
  - 颜色：`#333333`
  - 宽度：60dp，居中显示

- **增加按钮（PlusButton）**
  - 图标：`+`
  - 尺寸：32dp × 32dp
  - 边框：1dp，颜色：`#DDDDDD`
  - 圆角：4dp
  - 点击后数量加1，最大值为99
  - 当数量达到99时按钮置灰不可点击

---

#### **系列选择区（SeriesSelector）**
- **标题**：`更多系列`
  - 字号：16sp Bold
  - 颜色：`#333333`

- **系列选项（SeriesOptions）**
  - 展示多个系列选项，如：
    - `iPhone 13`
    - `iPhone 14 Plus`
    - `iPhone 15` ← 默认选中（红色边框）
    - `iPhone 15 Pro`
    - `iPhone 15 Plus`
    - `15 Pro Max`

- **选项样式**：
  - 未选中：
    - 背景色：`#F5F5F5`
    - 文字颜色：`#333333`
    - 边框：1dp，颜色：`#E0E0E0`
  - 选中状态：
    - 背景色：`#FFF0F0`
    - 文字颜色：`#E2231A`（红色）
    - 边框：2dp，颜色：`#E2231A`
  - 圆角：8dp
  - padding：8dp 16dp
  - 字号：14sp
  - 排列方式：Flow布局，自动换行

---

#### **外观颜色选择区（ColorSelector）**
- **标题**：`外观 (5)`
  - 字号：16sp Bold
  - 颜色：`#333333`
  - 右侧显示列表切换图标：`☰ 列表`（可选）

- **颜色选项（ColorOptions）**
  - 展示5种颜色的商品图片，如：
    - 黑色
    - 粉色
    - 蓝色 ← 默认选中
    - 绿色（无货）
    - 黄色（无货）

- **颜色卡片样式**：
  - 尺寸：100dp × 140dp
  - 圆角：8dp
  - 包含：
    - 商品图片（80dp × 80dp）
    - 颜色名称（如"蓝色"）
    - 价格标签（如"¥3399"）
    - 库存标签（"万人购买"或"无货"）

  - **选中状态**：
    - 边框：3dp，颜色：红色 `#E2231A`
    - 右上角显示红色角标"万人购买"

  - **无货状态**：
    - 图片半透明（opacity: 0.4）
    - 显示灰色"无货"标签
    - 不可点击

  - **放大图标（ZoomIcon）**：
    - 左上角显示放大图标 `🔍` 或 `Icons.Filled.ZoomIn`
    - 点击后查看大图（Toast提示"查看大图功能开发中"）

- **排列方式**：
  - 横向网格，2-3列
  - 使用 `LazyRow` 或 `Grid` 布局

---

#### **存储容量选择区（StorageSelector）**（可选，根据实际需求）
- **标题**：`版本`
  - 字号：16sp Bold
  - 颜色：`#333333`

- **容量选项（StorageOptions）**
  - 展示多个容量选项，如：
    - `128GB` ← 默认选中
    - `256GB`
    - `512GB`

- **选项样式**：与系列选择区相同
  - 未选中：灰色背景，黑色文字
  - 选中：红色边框，红色文字

---

#### **底部确认按钮（ConfirmButton）**
- **按钮文字**：`确定`
- **背景颜色**：红色 `#E2231A`
- **文字颜色**：白色 `#FFFFFF`
- **字号**：16sp Bold
- **高度**：48dp
- **圆角**：24dp
- **点击效果**：
  - 如果从"加入购物车"入口打开：
    - 点击后将当前选中的规格商品加入购物车
    - Toast提示"已加入购物车"
    - 关闭弹窗
    - 购物车角标数量更新
  - 如果从"立即购买"入口打开：
    - 点击后跳转至订单确认页（OrderConfirmActivity）
    - 携带当前选中的商品信息

---

### 页面结构说明
```
ProductSpecDialog（规格选择弹窗）
├── CloseButton（关闭按钮）
├── ProductInfoHeader（商品信息头部）
│   ├── ProductThumbnail（商品缩略图）
│   ├── PriceInfo（价格信息）
│   │   ├── CurrentPrice（当前价格）
│   │   ├── SubsidyTag（补贴标签）
│   │   ├── OriginalPrice（原价）
│   │   └── PromotionTags（促销标签列表）
│   └── ProductSKU（商品编号）
├── QuantitySelector（数量选择器）
│   ├── MinusButton（减少按钮）
│   ├── QuantityDisplay（数量显示）
│   └── PlusButton（增加按钮）
├── SeriesSelector（系列选择区）
│   ├── SectionTitle（标题：更多系列）
│   └── SeriesOptions（系列选项列表）
├── ColorSelector（外观颜色选择区）
│   ├── SectionTitle（标题：外观）
│   └── ColorOptions（颜色选项网格）
│       ├── ColorCard（颜色卡片）
│       │   ├── ZoomIcon（放大图标）
│       │   ├── ProductImage（商品图片）
│       │   ├── ColorName（颜色名称）
│       │   ├── PriceTag（价格标签）
│       │   └── StockTag（库存标签）
├── StorageSelector（存储容量选择区，可选）
│   ├── SectionTitle（标题：版本）
│   └── StorageOptions（容量选项列表）
└── ConfirmButton（底部确认按钮）
```

---

### 交互逻辑说明

#### **打开弹窗**
- 在商品详情页点击"加入购物车"或"立即购买"按钮时触发
- 弹窗从底部滑入，带有半透明遮罩层（背景色 `#80000000`）
- 点击遮罩层可关闭弹窗

#### **规格选择**
1. **系列选择**：
  - 点击系列选项，更新当前选中系列
  - 自动刷新可选颜色列表
  - 价格根据系列变化（静态数据）

2. **颜色选择**：
  - 点击颜色卡片，更新当前选中颜色
  - 更新商品缩略图
  - 更新价格信息
  - 无货颜色不可点击

3. **数量调整**：
  - 点击 `-` 减少数量，最小值为1
  - 点击 `+` 增加数量，最大值为99
  - 数量变化时不影响价格（单价固定）

#### **确认操作**
1. **加入购物车流程**：
  - 收集当前选中的规格信息（系列、颜色、容量、数量）
  - 将商品信息保存到本地购物车数据（SharedPreferences或内存）
  - 检查购物车中是否已存在相同规格商品：
    - 如果存在：数量累加
    - 如果不存在：新增一条记录
  - 更新购物车角标数量
  - Toast提示"已加入购物车"
  - 关闭弹窗
  - 保持在商品详情页

2. **立即购买流程**：
  - 收集当前选中的规格信息
  - 创建订单数据对象
  - 跳转至订单确认页（OrderConfirmActivity）
  - 关闭弹窗

#### **关闭弹窗**
- 点击右上角 `✕` 按钮
- 点击遮罩层
- 点击系统返回键
- 弹窗滑出动画，遮罩层淡出

---

### 数据结构补充

#### **规格选择数据（product_specs.json）**
```json
{
  "productId": "100066896464",
  "defaultSeries": "iPhone 15",
  "defaultColor": "蓝色",
  "defaultStorage": "128GB",
  "series": [
    {
      "name": "iPhone 13",
      "available": true
    },
    {
      "name": "iPhone 14 Plus",
      "available": true
    },
    {
      "name": "iPhone 15",
      "available": true,
      "selected": true
    },
    {
      "name": "iPhone 15 Pro",
      "available": true
    },
    {
      "name": "iPhone 15 Plus",
      "available": true
    },
    {
      "name": "15 Pro Max",
      "available": true
    }
  ],
  "colors": [
    {
      "name": "黑色",
      "colorCode": "#000000",
      "image": "iphone15_black.png",
      "price": 3399,
      "originalPrice": 3899,
      "available": true,
      "stockTag": "万人购买"
    },
    {
      "name": "粉色",
      "colorCode": "#FFB6C1",
      "image": "iphone15_pink.png",
      "price": 3699,
      "originalPrice": 3899,
      "available": true,
      "stockTag": "万人购买"
    },
    {
      "name": "蓝色",
      "colorCode": "#ADD8E6",
      "image": "iphone15_blue.png",
      "price": 3799,
      "originalPrice": 3899,
      "available": true,
      "stockTag": "万人购买",
      "selected": true
    },
    {
      "name": "绿色",
      "colorCode": "#90EE90",
      "image": "iphone15_green.png",
      "price": 3799,
      "originalPrice": 3899,
      "available": false,
      "stockTag": "无货"
    },
    {
      "name": "黄色",
      "colorCode": "#FFFFE0",
      "image": "iphone15_yellow.png",
      "price": 3799,
      "originalPrice": 3899,
      "available": false,
      "stockTag": "无货"
    }
  ],
  "storage": [
    {
      "capacity": "128GB",
      "available": true,
      "selected": true
    },
    {
      "capacity": "256GB",
      "available": true
    },
    {
      "capacity": "512GB",
      "available": true
    }
  ],
  "promotionInfo": {
    "subsidyText": "政府补贴价",
    "subsidyAmount": 100,
    "tags": [
      "政府补贴已减100",
      "国家贴息 12期免息"
    ]
  }
}
```

#### **购物车数据结构（cart_items.json）**
```json
{
  "items": [
    {
      "id": "cart_item_001",
      "productId": "100066896464",
      "productName": "Apple/苹果 iPhone 15 (A3092) 128GB",
      "series": "iPhone 15",
      "color": "蓝色",
      "storage": "128GB",
      "image": "iphone15_blue.png",
      "price": 3799,
      "originalPrice": 3899,
      "quantity": 1,
      "selected": true,
      "promotionTags": [
        "政府补贴满1000减100",
        "12期免息",
        "7天价保"
      ],
      "subsidyInfo": "比加入时降¥100",
      "storeName": "Apple产品京东自营旗舰店"
    }
  ],
  "totalCount": 1,
  "totalPrice": 3799
}
```

---

### 设计规范

#### **一、弹窗样式**
- **背景颜色**：白色 `#FFFFFF`
- **圆角**：顶部圆角 16dp
- **阴影**：elevation 8dp
- **最大高度**：屏幕高度的 80%
- **内容滚动**：使用 `LazyColumn` 支持滚动

#### **二、遮罩层**
- **背景颜色**：半透明黑色 `#80000000`
- **点击事件**：点击遮罩关闭弹窗

#### **三、动画效果**
- **弹出动画**：从底部滑入（300ms，Ease Out）
- **关闭动画**：向底部滑出（250ms，Ease In）
- **遮罩动画**：淡入淡出（200ms）

#### **四、颜色规范**
- **主色调**：红色 `#E2231A`
- **辅助色**：绿色 `#4CAF50`（补贴标签）
- **背景色**：白色 `#FFFFFF`
- **分割线**：`#F0F0F0`
- **文字颜色**：
  - 主文字：`#333333`
  - 次要文字：`#666666`
  - 提示文字：`#999999`
  - 价格：红色 `#E2231A`

#### **五、间距规范**
- **内容边距**：左右 16dp，上下 12dp
- **模块间距**：16dp
- **元素间距**：8dp

---

### 组件文件说明
新增以下组件文件：
- `ProductSpecDialog.kt` - 规格选择弹窗主文件
- `product_spec_header.kt` - 商品信息头部组件
- `product_spec_quantity_selector.kt` - 数量选择器组件
- `product_spec_series_selector.kt` - 系列选择组件
- `product_spec_color_selector.kt` - 颜色选择组件
- `product_spec_storage_selector.kt` - 容量选择组件（可选）

---

### 购物车页面更新需求

#### **购物车列表更新**
当用户从规格选择弹窗点击"确定"后，购物车页面需要同步更新：

1. **数据刷新**：
  - 读取最新的购物车数据（cart_items.json 或内存）
  - 更新购物车列表显示

2. **商品卡片显示**（参考第二张截图）：
  - **店铺信息**：
    - 店铺图标：红色 `自营` 标签
    - 店铺名称：如"Apple产品京东自营旗舰店"
    - 右侧箭头：`>`
    - 补贴信息：如"政府补贴满1000减100"（红色文字）

  - **商品信息**：
    - 左侧多选框（圆形，选中时显示红色勾选）
    - 商品图片（80dp × 80dp，圆角 8dp）
    - 商品标题：如"Apple/苹果 iPhone 15 (A3092) 128GB"
    - 规格信息：如"蓝色，128GB"（可下拉展开）
    - 促销标签：
      - "政府补贴满1000减100"（绿色背景）
      - "12期免息"
      - "7天价保"
    - 价格变动提示：如"比加入时降¥100"（红色文字）

  - **价格与数量**：
    - 当前价格：`¥3799`（红色，16sp Bold）
    - 补贴价标签：`政府补贴价`（绿色背景）
    - 原价：`¥3899`（删除线，灰色）
    - 数量选择器：`-` `1` `+`（样式同规格弹窗）

3. **角标更新**：
  - 底部导航栏"购物车"图标右上角显示商品总数量
  - 数量超过99时显示"99+"

4. **底部结算栏**：
  - 全选按钮（圆形多选框）
  - 合计金额：`合计：¥0.00`（红色，大字号）
  - 结算按钮：`去结算`（红色背景，白色文字）
  - 点击"去结算"跳转至订单确认页

---

### 开发注意事项

1. **状态管理**：
  - 使用 `ViewModel` 管理规格选择状态
  - 使用 `StateFlow` 或 `LiveData` 监听购物车数据变化

2. **数据持久化**：
  - 购物车数据使用 SharedPreferences 或内存存储
  - 每次添加商品后立即保存
  - App重启后需要恢复购物车数据

3. **数据校验**：
  - 检查用户是否选择了所有必需的规格（颜色、容量等）
  - 检查库存状态，无货商品不可加入购物车
  - 数量必须在 1-99 之间

4. **性能优化**：
  - 颜色图片使用 Coil 或 Glide 异步加载
  - 规格列表使用 LazyColumn 延迟加载
  - 避免频繁刷新整个列表

5. **用户体验**：
  - 操作按钮添加点击反馈（涟漪效果）
  - 加入购物车成功后有明确的Toast提示
  - 弹窗打开/关闭要有流畅的动画效果

6. **边界情况处理**：
  - 购物车为空时显示空状态页面
  - 商品规格不完整时提示用户选择
  - 库存不足时禁用"确定"按钮

---

### 测试要点

1. **规格选择测试**：
  - 测试不同系列、颜色、容量的组合
  - 测试无货商品的禁用状态
  - 测试数量加减的边界值（1和99）

2. **购物车测试**：
  - 添加相同规格商品，验证数量累加
  - 添加不同规格商品，验证列表更新
  - 删除商品，验证列表和角标更新
  - 修改商品数量，验证价格计算

3. **交互测试**：
  - 测试弹窗打开/关闭动画
  - 测试遮罩层点击关闭
  - 测试系统返回键关闭弹窗
  - 测试"立即购买"和"加入购物车"两种流程

4. **数据持久化测试**：
  - 添加商品后关闭App，重新打开验证数据
  - 测试多次添加/删除操作的数据一致性

---

### 预期效果

完成后，用户应该能够：
1. 在商品详情页点击"加入购物车"或"立即购买"弹出规格选择弹窗
2. 在弹窗中选择系列、颜色、容量和数量
3. 点击"确定"后成功将商品加入购物车
4. 在购物车页面看到新添加的商品
5. 购物车角标正确显示商品数量
6. 修改购物车中商品的数量和规格
7. 选择商品后进入结算流程

---